<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TELA 2 - An√°lise de Propriedade</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        /* Carrossel */
        .carousel-container {
            position: relative;
            width: 100%;
            height: 600px;
            overflow: hidden;
        }
        
        .carousel-slide {
            display: none;
            width: 100%;
            height: 100%;
        }
        
        .carousel-slide.active {
            display: block;
        }
        
        .carousel-slide iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .carousel-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 20px;
            cursor: pointer;
            font-size: 24px;
            z-index: 10;
            transition: background 0.3s;
        }
        
        .carousel-arrow:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        
        .carousel-arrow.left {
            left: 20px;
        }
        
        .carousel-arrow.right {
            right: 20px;
        }
        
        .carousel-indicators {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .carousel-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .carousel-indicator.active {
            background: white;
        }
        
        /* Anima√ß√µes */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        /* Bot√µes de an√°lise */
        .analysis-btn {
            transition: all 0.2s ease;
        }
        
        .analysis-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .analysis-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Checkpoint */
        .checkpoint {
            border: 2px dashed #d1d5db;
            background: #f9fafb;
        }
        
        .checkpoint.passed {
            border-color: #10b981;
            background: #d1fae5;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <div class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex gap-2">
                    <button onclick="goBack()" class="flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                        <span>‚Üê</span>
                        <span>Voltar</span>
                    </button>
                    <button onclick="window.location.href='settings.html'" class="flex items-center gap-2 px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors" title="Configurar API Key">
                        <span>‚öôÔ∏è</span>
                    </button>
                </div>
                
                <div class="text-center">
                    <h1 class="text-2xl font-bold text-gray-800">An√°lise de Propriedade</h1>
                    <p class="text-sm text-gray-600">Propriedade <span id="currentPropertyIndex">1</span> de <span id="totalProperties">3</span></p>
                </div>
                
                <button onclick="exportAnalysis()" class="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    <span>üì•</span>
                    <span>Exportar An√°lises</span>
                </button>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-6">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Coluna Esquerda: Carrossel de Imagens -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                    <div class="carousel-container">
                        <!-- Slide 1: Street View -->
                        <div class="carousel-slide active">
                            <iframe id="streetViewFrame" src="" allow="fullscreen"></iframe>
                        </div>
                        
                        <!-- Slide 2: Satellite View -->
                        <div class="carousel-slide">
                            <iframe id="satelliteFrame" src="" allow="fullscreen"></iframe>
                        </div>
                        
                        <!-- Setas de navega√ß√£o -->
                        <button class="carousel-arrow left" onclick="prevSlide()">‚Äπ</button>
                        <button class="carousel-arrow right" onclick="nextSlide()">‚Ä∫</button>
                        
                        <!-- Indicadores -->
                        <div class="carousel-indicators">
                            <div class="carousel-indicator active" onclick="goToSlide(0)"></div>
                            <div class="carousel-indicator" onclick="goToSlide(1)"></div>
                        </div>
                    </div>
                    
                    <!-- Labels -->
                    <div class="p-4 bg-gray-50 text-center">
                        <p class="text-sm font-semibold text-gray-700">
                            <span id="currentViewLabel">Street View</span>
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Coluna Direita: Informa√ß√µes e Bot√µes -->
            <div class="space-y-6">
                <!-- Informa√ß√µes da Propriedade -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">üìã Informa√ß√µes</h2>
                    <div class="space-y-3 text-sm">
                        <div>
                            <span class="font-semibold text-gray-700">Address:</span>
                            <p class="text-gray-600" id="propAddress">123 Main St, Miami, FL</p>
                        </div>
                        <div>
                            <span class="font-semibold text-gray-700">Parcel:</span>
                            <p class="text-gray-600" id="propParcel">12-3456-789-0123</p>
                        </div>
                        <div>
                            <span class="font-semibold text-gray-700">County:</span>
                            <p class="text-gray-600" id="propCounty">Miami-Dade</p>
                        </div>
                        <div>
                            <span class="font-semibold text-gray-700">Acres:</span>
                            <p class="text-gray-600" id="propAcres">0.25</p>
                        </div>
                        <div>
                            <span class="font-semibold text-gray-700">Amount Due:</span>
                            <p class="text-gray-600 font-bold text-green-600" id="propAmount">$2,500</p>
                        </div>
                    </div>
                </div>
                
                <!-- GRUPO 1: An√°lises B√°sicas -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">üîç GRUPO 1: An√°lises B√°sicas</h2>
                    <div class="space-y-3">
                        <button onclick="analyzeCrime()" class="analysis-btn w-full px-4 py-3 bg-red-600 text-white rounded-lg text-left flex items-center gap-3 hover:bg-red-700">
                            <span class="text-2xl">üö®</span>
                            <div class="flex-1">
                                <div class="font-semibold">Crime Info</div>
                                <div class="text-xs opacity-90">Estat√≠sticas de criminalidade</div>
                            </div>
                        </button>
                        
                        <button onclick="analyzeDisasters()" class="analysis-btn w-full px-4 py-3 bg-orange-600 text-white rounded-lg text-left flex items-center gap-3 hover:bg-orange-700">
                            <span class="text-2xl">üå™Ô∏è</span>
                            <div class="flex-1">
                                <div class="font-semibold">Disaster Info</div>
                                <div class="text-xs opacity-90">Zonas de risco (FEMA)</div>
                            </div>
                        </button>
                        
                        <button onclick="analyzeZoning()" class="analysis-btn w-full px-4 py-3 bg-purple-600 text-white rounded-lg text-left flex items-center gap-3 hover:bg-purple-700">
                            <span class="text-2xl">üìã</span>
                            <div class="flex-1">
                                <div class="font-semibold">Zoning Info</div>
                                <div class="text-xs opacity-90">Zoneamento e uso permitido</div>
                            </div>
                        </button>
                        
                        <button onclick="analyzeImages()" class="analysis-btn w-full px-4 py-3 bg-pink-600 text-white rounded-lg text-left flex items-center gap-3 hover:bg-pink-700">
                            <span class="text-2xl">üì∏</span>
                            <div class="flex-1">
                                <div class="font-semibold">An√°lise de Imagens IA</div>
                                <div class="text-xs opacity-90">Google Vision AI</div>
                            </div>
                        </button>
                    </div>
                </div>
                
                <!-- Checkpoint -->
                <div id="checkpoint" class="checkpoint rounded-lg p-4 text-center">
                    <p class="text-sm font-semibold text-gray-600">
                        <span id="checkpointIcon">‚è≥</span>
                        <span id="checkpointText">Complete as an√°lises acima para desbloquear GRUPO 2</span>
                    </p>
                    <button onclick="passCheckpoint()" class="mt-3 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-semibold">
                        ‚úì Passou na Elimina√ß√£o
                    </button>
                </div>
                
                <!-- GRUPO 2: An√°lises Avan√ßadas (Bloqueado) -->
                <div id="group2" class="bg-white rounded-lg shadow-lg p-6 opacity-50">
                    <h2 class="text-lg font-bold text-gray-800 mb-4">üí∞ GRUPO 2: An√°lises Avan√ßadas</h2>
                    <div class="space-y-3">
                        <button disabled class="analysis-btn w-full px-4 py-3 bg-indigo-600 text-white rounded-lg text-left flex items-center gap-3">
                            <span class="text-2xl">üîç</span>
                            <div class="flex-1">
                                <div class="font-semibold">Comps + BID</div>
                                <div class="text-xs opacity-90">An√°lise de mercado e lance</div>
                            </div>
                            <span class="text-xs">üîí</span>
                        </button>
                        
                        <button disabled class="analysis-btn w-full px-4 py-3 bg-blue-600 text-white rounded-lg text-left flex items-center gap-3">
                            <span class="text-2xl">ü§ñ</span>
                            <div class="flex-1">
                                <div class="font-semibold">IA Recomenda</div>
                                <div class="text-xs opacity-90">Propriedades similares</div>
                            </div>
                            <span class="text-xs">üîí</span>
                        </button>
                        
                        <button disabled class="analysis-btn w-full px-4 py-3 bg-teal-600 text-white rounded-lg text-left flex items-center gap-3">
                            <span class="text-2xl">üìä</span>
                            <div class="flex-1">
                                <div class="font-semibold">Simulador</div>
                                <div class="text-xs opacity-90">Cen√°rios de ROI</div>
                            </div>
                            <span class="text-xs">üîí</span>
                        </button>
                    </div>
                </div>
                
                <!-- Navega√ß√£o entre Propriedades -->
                <div class="flex gap-3">
                    <button onclick="prevProperty()" class="flex-1 px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-semibold">
                        ‚Üê Anterior
                    </button>
                    <button onclick="nextProperty()" class="flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                        Pr√≥xima ‚Üí
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados de exemplo (substituir por dados reais)
        const properties = [
            {
                address: "123 Main St, Miami, FL 33101",
                parcel: "12-3456-789-0123",
                county: "Miami-Dade",
                acres: "0.25",
                amount: "$2,500",
                lat: 25.7617,
                lng: -80.1918
            },
            {
                address: "456 Oak Ave, Orlando, FL 32801",
                parcel: "45-6789-012-3456",
                county: "Orange",
                acres: "0.50",
                amount: "$3,200",
                lat: 28.5383,
                lng: -81.3792
            },
            {
                address: "789 Pine Rd, Tampa, FL 33602",
                parcel: "78-9012-345-6789",
                county: "Hillsborough",
                acres: "0.75",
                amount: "$4,100",
                lat: 27.9506,
                lng: -82.4572
            }
        ];
        
        let currentPropertyIndex = 0;
        let currentSlide = 0;
        let group2Unlocked = false;
        
        // Inicializar
        function init() {
            loadProperty(currentPropertyIndex);
            updatePropertyCounter();
        }
        
        // Carregar propriedade
        function loadProperty(index) {
            const prop = properties[index];
            
            document.getElementById('propAddress').textContent = prop.address;
            document.getElementById('propParcel').textContent = prop.parcel;
            document.getElementById('propCounty').textContent = prop.county;
            document.getElementById('propAcres').textContent = prop.acres;
            document.getElementById('propAmount').textContent = prop.amount;
            
            // Atualizar iframes
            // Obter API key do localStorage (configurada em settings.html)
            const apiKey = localStorage.getItem('googleMapsApiKey') || 'AIzaSyBr4UtMOvkhX6LxYOw89zjBkOYNO-_ykag';
            const streetViewUrl = `https://www.google.com/maps/embed/v1/streetview?key=${apiKey}&location=${prop.lat},${prop.lng}&heading=0&pitch=0&fov=90`;
            const satelliteUrl = `https://www.google.com/maps/embed/v1/view?key=${apiKey}&center=${prop.lat},${prop.lng}&zoom=18&maptype=satellite`;
            
            document.getElementById('streetViewFrame').src = streetViewUrl;
            document.getElementById('satelliteFrame').src = satelliteUrl;
            
            // Reset checkpoint
            resetCheckpoint();
        }
        
        // Carrossel
        function showSlide(index) {
            const slides = document.querySelectorAll('.carousel-slide');
            const indicators = document.querySelectorAll('.carousel-indicator');
            const labels = ['Street View', 'Satellite View'];
            
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            
            indicators.forEach((indicator, i) => {
                indicator.classList.toggle('active', i === index);
            });
            
            document.getElementById('currentViewLabel').textContent = labels[index];
            currentSlide = index;
        }
        
        function nextSlide() {
            currentSlide = (currentSlide + 1) % 2;
            showSlide(currentSlide);
        }
        
        function prevSlide() {
            currentSlide = (currentSlide - 1 + 2) % 2;
            showSlide(currentSlide);
        }
        
        function goToSlide(index) {
            showSlide(index);
        }
        
        // Navega√ß√£o entre propriedades
        function nextProperty() {
            if (currentPropertyIndex < properties.length - 1) {
                currentPropertyIndex++;
                loadProperty(currentPropertyIndex);
                updatePropertyCounter();
            }
        }
        
        function prevProperty() {
            if (currentPropertyIndex > 0) {
                currentPropertyIndex--;
                loadProperty(currentPropertyIndex);
                updatePropertyCounter();
            }
        }
        
        function updatePropertyCounter() {
            document.getElementById('currentPropertyIndex').textContent = currentPropertyIndex + 1;
            document.getElementById('totalProperties').textContent = properties.length;
        }
        
        // Fun√ß√µes de an√°lise (GRUPO 1)
        function analyzeCrime() {
            alert('üö® An√°lise de Crime Info\n\nAbrindo SpotCrime...');
            // Implementar integra√ß√£o real
        }
        
        function analyzeDisasters() {
            alert('üå™Ô∏è An√°lise de Disaster Info\n\nConsultando FEMA...');
            // Implementar integra√ß√£o real
        }
        
        function analyzeZoning() {
            alert('üìã An√°lise de Zoning Info\n\nAbrindo informa√ß√µes de zoneamento...');
            // Implementar integra√ß√£o real
        }
        
        function analyzeImages() {
            alert('üì∏ An√°lise de Imagens IA\n\nProcessando com Google Vision AI...');
            // Implementar integra√ß√£o real
        }
        
        // Checkpoint
        function passCheckpoint() {
            const checkpoint = document.getElementById('checkpoint');
            const group2 = document.getElementById('group2');
            
            checkpoint.classList.add('passed');
            document.getElementById('checkpointIcon').textContent = '‚úÖ';
            document.getElementById('checkpointText').textContent = 'Passou na Elimina√ß√£o! GRUPO 2 desbloqueado';
            
            group2.classList.remove('opacity-50');
            group2.querySelectorAll('button').forEach(btn => {
                btn.disabled = false;
                btn.classList.remove('cursor-not-allowed');
                btn.querySelector('.text-xs:last-child').textContent = 'üîì';
            });
            
            group2Unlocked = true;
        }
        
        function resetCheckpoint() {
            const checkpoint = document.getElementById('checkpoint');
            const group2 = document.getElementById('group2');
            
            checkpoint.classList.remove('passed');
            document.getElementById('checkpointIcon').textContent = '‚è≥';
            document.getElementById('checkpointText').textContent = 'Complete as an√°lises acima para desbloquear GRUPO 2';
            
            group2.classList.add('opacity-50');
            group2.querySelectorAll('button').forEach(btn => {
                btn.disabled = true;
                btn.querySelector('.text-xs:last-child').textContent = 'üîí';
            });
            
            group2Unlocked = false;
        }
        
        // Outras fun√ß√µes
        function goBack() {
            window.history.back();
        }
        
        function exportAnalysis() {
            alert('üì• Exportando an√°lises...\n\nFuncionalidade em desenvolvimento');
        }
        
        // Suporte a teclado
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') prevSlide();
            if (e.key === 'ArrowRight') nextSlide();
        });
        
        // Suporte a swipe (mobile)
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.querySelector('.carousel-container').addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });
        
        document.querySelector('.carousel-container').addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });
        
        function handleSwipe() {
            if (touchEndX < touchStartX - 50) nextSlide();
            if (touchEndX > touchStartX + 50) prevSlide();
        }
        
        // Inicializar ao carregar
        init();
    </script>
</body>
</html>

